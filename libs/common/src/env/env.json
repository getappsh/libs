{
  "$schema": "./env.schema.json",
  "title": "Get-App, Environment documentation",
  "id": "get-app",
  "description": "Environment variables documentation for get-app microservice.",
  "version": "1.0.0",
  "scopes": [
    {
      "title": "General Configuration",
      "id": "general",
      "description": "General environment variables used for all microservices",
      "variables": [
        {
          "name": "REGION",
          "description": "Defines the region used for Kafka topics and database names. ",
          "warning": "If implemented, it must be consistent across all microservices.",
          "required": false,
          "type": "string"
        },
        {
          "name": "SERVER_NAME",
          "description": "Name of the server instance.",
          "warning": "Should be unique within the deployment environment.",
          "required": false,
          "type": "string"
        },
        {
          "name": "DEPLOY_ENV",
          "description": "Deployment environment identifier. Typical values: CTS or TNG.",
          "required": false,
          "type": "enum",
          "enum": [
            "CTS",
            "TNG"
          ],
          "hidden": true
        },
        {
          "name": "LOGGER_FORMAT",
          "description": "Format of the logs output by the microservice. Can be JSON or STRING.",
          "required": false,
          "type": "enum",
          "enum": [
            "JSON",
            "STRING"
          ],
          "default": "STRING"
        },
        {
          "name": "LOG_LEVEL",
          "description": "Defines the logging level. For JSON logger: [\"fatal\", \"error\", \"warn\", \"info\", \"debug\", \"trace\"]. For STRING logger: [\"log\", \"error\", \"warn\", \"debug\", \"verbose\"].",
          "required": true,
          "type": "enum",
          "enum": [
            "fatal",
            "error",
            "warn",
            "info",
            "debug",
            "trace",
            "log",
            "verbose"
          ],
          "default": " \"trace\" or \"verbose\""
        }
      ]
    },
    {
      "title": "Api microservice",
      "description": "Environment variables for api microservice.",
      "variables": [
        {
          "name": "SERVER_PORT",
          "description": "The port on which the API server will run",
          "type": "number",
          "default": 3000,
          "required": false
        }
      ]
    },
    {
      "title": "Authentication service",
      "description": "Authentication environment variables",
      "variables": [
        {
          "name": "AUTH_SERVER_URL",
          "description": "URL of the Keycloak authentication server",
          "required": true,
          "type": "string",
          "format": "uri",
          "subTitle": "SSO Auth"
        },
        {
          "name": "REALM",
          "description": "Realm used in Keycloak",
          "required": true,
          "type": "string",
          "subTitle": "SSO Auth"
        },
        {
          "name": "CLIENT_ID",
          "description": "Client ID registered in Keycloak",
          "required": true,
          "type": "string",
          "subTitle": "SSO Auth"
        },
        {
          "name": "SECRET_KEY",
          "description": "Secret key for Keycloak client",
          "required": true,
          "type": "string",
          "subTitle": "SSO Auth"
        },
        {
          "name": "COOKIE_KEY",
          "description": "Key used to sign and encrypt cookies",
          "required": true,
          "type": "string",
          "subTitle": "SSO Auth"
        },
        {
          "name": "DEVICE_AUTH",
          "description": "A secret key to check against the value in the Device-Auth header",
          "required": false,
          "type": "string",
          "subTitle": "Secret Auth"
        },
        {
          "name": "DEVICE_SECRET",
          "description": "A secret key to check against the value in the Device-Auth header",
          "required": false,
          "type": "string",
          "subTitle": "Secret Auth",
          "deprecated": true,
          "deprecationNote": "Use DEVICE_AUTH instead"
        }
      ]
    },
    {
      "title": "Get-map microservice",
      "description": "Environment variables for get-map microservice.",
      "variables": [
        {
          "name": "LIBOT_DISCOVERY_URL",
          "description": "The url of the libot discovery service",
          "type": "string",
          "format": "uri",
          "required": true,
          "subTitle": "libot"
        },
        {
          "name": "LIBOT_EXPORT_URL",
          "description": "The url of the libot export service",
          "type": "string",
          "format": "uri",
          "required": true,
          "subTitle": "libot"
        },
        {
          "name": "LIBOT_CALLBACK_URL",
          "description": "The url provided to libot to call back to the service",
          "type": "string",
          "format": "uri",
          "required": true,
          "subTitle": "libot"
        },
        {
          "name": "TOKEN_LIBOT",
          "description": "The token to authenticate with libot",
          "type": "string",
          "required": true,
          "subTitle": "libot"
        },
        {
          "name": "PROXY_DOWNLOAD_BASE_URL",
          "description": "When using proxy server for vpn connection, this prefix will change the original prefix",
          "type": "string",
          "format": "uri",
          "required": false
        },
        {
          "name": "MC_CSW_REF_DATE",
          "description": "The reference date for the filter products",
          "type": "string",
          "format": "date-time",
          "default": "2023-10-15T00:00:01Z",
          "required": false,
          "subTitle": "products filtering params"
        },
        {
          "name": "TARGET_RESOLUTION",
          "description": "The target resolution for filtering products",
          "type": "number",
          "default": 17,
          "required": false,
          "subTitle": "products filtering params"
        },
        {
          "name": "MC_MIN_RESOLUTION_DEG",
          "description": "The minimum resolution for exporting maps",
          "type": "number",
          "default": 4.29153E-05,
          "required": true,
          "subTitle": "products filtering params"
        },
        {
          "name": "MC_MAX_RESOLUTION_DEG",
          "description": "The maximum resolution for exporting maps",
          "type": "number",
          "default": 1.34110E-06,
          "required": true,
          "subTitle": "products filtering params"
        },
        {
          "name": "PRODUCTS_CREATION_METHOD",
          "description": "set the method to create products",
          "type": "enum",
          "enum": [
            "single",
            "polygonParts"
          ],
          "default": "single",
          "required": false,
          "subTitle": "WFS supporting"
        },
        {
          "name": "POLYGON_PARTS_WFS",
          "description": "The url of the polygon parts wfs service. Required if using the 'polygonParts' method in PRODUCTS_CREATION_METHOD.",
          "type": "string",
          "format": "uri",
          "required": {
            "if": {
              "PRODUCTS_CREATION_METHOD": "polygonParts"
            },
            "then": true
          },
          "subTitle": "WFS supporting"
        },
        {
          "name": "MANEUVER_AREA",
          "description": "The maneuver area for the polygon parts method, in the format of 'lat,lon,lat,lon,...'. Required if using the 'polygonParts' method in PRODUCTS_CREATION_METHOD.",
          "type": "string",
          "pattern": "^(-?\\d+(?:\\.\\d+)?),(-?\\d+(?:\\.\\d+)?)(,(-?\\d+(?:\\.\\d+)?),(-?\\d+(?:\\.\\d+)?))*$",
          "example": "32.1,34.8,32.2,34.9,32.3,35.0",
          "required": {
            "if": {
              "PRODUCTS_CREATION_METHOD": "polygonParts"
            },
            "then": true
          },
          "subTitle": "WFS supporting"
        },
        {
          "name": "SEQUENTIAL_PRODUCT_ID",
          "description": "The sequential product id for the polygon parts method, in format of 'productId-productType'. Required if using the 'polygonParts' method in PRODUCTS_CREATION_METHOD.",
          "type": "string",
          "pattern": "^[a-zA-Z0-9]+-[a-zA-Z0-9]+$",
          "example": "12345-ortho",
          "required": {
            "if": {
              "PRODUCTS_CREATION_METHOD": "polygonParts"
            },
            "then": true
          },
          "subTitle": "WFS supporting"
        },
        {
          "name": "UPDATE_GOB_TIME",
          "description": "The cron time to update the GOB, default is every 6 hours",
          "type": "string",
          "default": "0 0 */6 * * *",
          "pattern": "^([0-5]?\\d)\\s([0-5]?\\d)\\s([0-2]?\\d|\\*)\\s([1-9]|1[0-2]|\\*)\\s([0-6]|\\*)\\s([0-7]|\\*)$",
          "required": false,
          "subTitle": "service configs"
        },
        {
          "name": "PRODUCTS_STALE_AFTER",
          "description": "The time in minutes to consider a product stale, default is 3 minute",
          "type": "number",
          "default": 3,
          "required": false,
          "subTitle": "service configs"
        },
        {
          "name": "USE_PRODUCTS_CACHE",
          "description": "A flag if using cache for products, default is true",
          "type": "boolean",
          "default": true,
          "required": false,
          "subTitle": "service configs"
        },
        {
          "name": "PERIODIC_GET_MAP_STATUS",
          "description": "Seconds to set the periodic time to request status for map â€” default is 3 seconds",
          "type": "number",
          "default": 3,
          "required": false,
          "subTitle": "service configs"
        },
        {
          "name": "MAP_RETRY_EXPONENTIAL_TIMES",
          "description": "The exponential times for retrying the request in array, default is [0.3, 5, 15]",
          "type": "string",
          "default": "[0.3, 5, 15]",
          "pattern": "^\\[\\s*(\\d+(\\.\\d+)?)(\\s*,\\s*\\d+(\\.\\d+)?)*\\s*\\]$",
          "required": false,
          "subTitle": "service configs"
        },
        {
          "name": "MAP_RETRY_WAIT_TIME",
          "description": "The time to wait between retries, default is 0.3",
          "type": "number",
          "default": 0.3,
          "required": false,
          "subTitle": "service configs"
        },
        {
          "name": "MAP_RETRY_COUNT",
          "description": "The number of retries, default is 3",
          "type": "number",
          "default": 3,
          "required": false,
          "subTitle": "service configs"
        },
        {
          "name": "UPDATE_JOB_MAP_TAKE",
          "description": "The number of maps to take in each update job, default is 25",
          "type": "number",
          "default": 25,
          "required": false,
          "subTitle": "service configs"
        },
        {
          "name": "LIBOT_EMULATOR",
          "description": "set if use an emulator to emulate libot",
          "type": "boolean",
          "default": false,
          "required": false,
          "subTitle": "libot emulator"
        }
      ]
    },
    {
      "title": "Libot emulator microservice",
      "description": "Environment variables for libot emulator microservice.",
      "variables": [
        {
          "name": "LIBOT_SERVER_ADDRESS",
          "description": "The address of the libot server",
          "type": "string",
          "format": "uri",
          "required": true
        }
      ]
    }
  ]
}